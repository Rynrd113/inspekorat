window.Admin=window.Admin||{},Admin.Session={timeoutMinutes:120,warningMinutes:10,lastActivity:Date.now(),timeoutTimer:null,warningTimer:null,init:function(){this.resetTimers(),this.bindEvents()},resetTimers:function(){clearTimeout(this.timeoutTimer),clearTimeout(this.warningTimer),this.lastActivity=Date.now(),this.warningTimer=setTimeout(()=>{this.showSessionWarning()},60*(this.timeoutMinutes-this.warningMinutes)*1e3),this.timeoutTimer=setTimeout(()=>{this.handleSessionExpiry()},60*this.timeoutMinutes*1e3)},bindEvents:function(){["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach(t=>{document.addEventListener(t,()=>{this.updateActivity()},{passive:!0})})},updateActivity:function(){const t=Date.now();t-this.lastActivity>3e5&&(this.lastActivity=t,this.resetTimers())},showSessionWarning:function(){confirm("Sesi Anda akan berakhir dalam 10 menit. Klik OK untuk memperpanjang sesi.")&&this.extendSession()},handleSessionExpiry:function(){alert("Sesi Anda telah berakhir. Anda akan dialihkan ke halaman login."),window.location.href="/admin/login"},extendSession:function(){var t;fetch("/admin/extend-session",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":null==(t=document.querySelector('meta[name="csrf-token"]'))?void 0:t.content}}).then(t=>{t.ok&&this.resetTimers()}).catch(t=>{})}},Admin.debounce=function(t,e){let i;return function(...n){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),t(...n)},e)}},Admin.Modal={activeModal:null,open:function(t){const e=document.getElementById(t);e&&(e.classList.remove("hidden"),e.setAttribute("aria-hidden","false"),this.activeModal=t,document.body.style.overflow="hidden")},close:function(t){const e=document.getElementById(t);e&&(e.classList.add("hidden"),e.setAttribute("aria-hidden","true"),this.activeModal=null,document.body.style.overflow="")}},Admin.Notification={show:function(t,e="info",i=5e3){const n=document.createElement("div");n.className=`notification notification-${e}`,n.innerHTML=`\n            <div class="notification-content">\n                <span class="notification-message">${t}</span>\n                <button class="notification-close" aria-label="Close">Ã—</button>\n            </div>\n        `,document.body.appendChild(n),setTimeout(()=>{this.hide(n)},i),n.querySelector(".notification-close").addEventListener("click",()=>{this.hide(n)})},hide:function(t){t.classList.add("notification-fade-out"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},300)}},Admin.init=function(){void 0!==Admin.Session&&Admin.Session.init(),document.addEventListener("click",function(t){const e=t.target.closest("[data-modal-open]");if(e){t.preventDefault();const i=e.dataset.modalOpen;Admin.Modal.open(i)}const i=t.target.closest("[data-modal-close]");if(i){t.preventDefault();const e=i.dataset.modalClose||i.closest('[role="dialog"]').id;Admin.Modal.close(e)}}),document.addEventListener("keydown",function(t){if("Escape"===t.key){const t=document.querySelector('[role="dialog"]:not(.hidden)');t&&Admin.Modal.close(t.id)}})},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Admin.init):Admin.init(),window.openModal=Admin.Modal.open,window.closeModal=Admin.Modal.close,window.showNotification=Admin.Notification.show;
